# Architecture Decision: Root Layout Pattern

**Token**: [ARCH-LAYOUT_PATTERN]  
**Status**: âœ… Implemented  
**Last Updated**: 2026-02-06

## Context and Problem Statement

The application requires a way to share common UI elements, HTML structure, metadata, and styling across all pages without code duplication. The pattern must integrate with Next.js routing and support TypeScript type safety.

## Decision Drivers

- **Code Reuse**: Avoid duplicating HTML structure across pages
- **Consistency**: Ensure consistent styling and fonts on all pages
- **Metadata**: Centralize default metadata (title, description)
- **Performance**: Layouts should not re-render unnecessarily
- **Type Safety**: Layout should be type-safe with TypeScript
- **Next.js Integration**: Must work with App Router
- **Extensibility**: Enable nested layouts in the future

## Considered Options

1. **Next.js Root Layout** - App Router layout.tsx pattern
2. **HOC (Higher-Order Component)** - Wrap pages with layout component
3. **Component Composition** - Manual layout composition in each page
4. **Pages _app.tsx** - Legacy Pages Router approach

## Decision Outcome

**Chosen option**: "Next.js Root Layout (layout.tsx)"

### Rationale

Root Layout pattern provides:
- **Automatic Wrapping**: All pages wrapped automatically
- **HTML Root**: Control `<html>` and `<body>` tags
- **No Re-render**: Layout doesn't re-render on navigation
- **Shared State**: Can share UI state across pages
- **Metadata**: Export metadata for all pages
- **Type Safe**: TypeScript types provided by Next.js
- **Nested Support**: Can nest layouts in subdirectories
- **Server Component**: Renders on server by default

### Positive Consequences

- Zero boilerplate per page (automatic wrapping)
- Consistent HTML structure guaranteed
- Font loading centralized
- Metadata inheritance built-in
- No layout re-render on page navigation
- Can nest layouts for route groups
- TypeScript ensures correct implementation
- Server-side rendering by default

### Negative Consequences

- Must be a server component (no hooks without "use client")
- Limited to one root layout per app
- Breaking changes if layout structure changes
- Must understand layout rendering lifecycle

## Requirements Fulfilled

- **[REQ-ROOT_LAYOUT]** - Root layout with HTML structure
- **[REQ-FONT_SYSTEM]** - Centralized font loading
- **[REQ-METADATA]** - Default metadata for all pages
- **[REQ-APP_STRUCTURE]** - Part of App Router structure

## Implementation Notes

### Layout Structure

**src/app/layout.tsx**:
```typescript
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        {children}
      </body>
    </html>
  );
}
```

### Key Features

1. **Font Variables**: Applied to body via className
2. **Global Styles**: Imported in layout
3. **Metadata**: Exported for SEO
4. **Children**: Rendered automatically
5. **HTML Tag**: Full control over document structure

### Layout Lifecycle

- Layout renders once on initial page load
- Children change on navigation, layout persists
- Layout is a Server Component by default
- Can't use hooks unless "use client" added

## Related Decisions

- **[ARCH-APP_ROUTER]** - Layout pattern is part of App Router
- **[ARCH-GOOGLE_FONTS]** - Fonts loaded in layout
- **[ARCH-SERVER_COMPONENTS]** - Layout is server component

## References

- [Next.js Layouts](https://nextjs.org/docs/app/building-your-application/routing/pages-and-layouts#layouts)
- [Root Layout](https://nextjs.org/docs/app/building-your-application/routing/pages-and-layouts#root-layout-required)

## Implementation Tokens

- **[IMPL-ROOT_LAYOUT]** - Root layout component implementation
- **[IMPL-FONT_LOADING]** - Font configuration in layout
- **[IMPL-METADATA]** - Metadata export in layout
